# Log 1

## V8

D:\v8\samples\hello-world.cc

1.InitializeExternalStartupData:v8启动为什么需要外部数据,需要哪些启动数据?
2.一个 std::unique_ptr 实例独占它所指向的动态对象（内存），即：

- 不允许两个 unique_ptr 指向同一个对象（禁止复制）；
- 只能通过「移动语义」转移所有权（使用 std::move），转移后原 unique_ptr 会变为 nullptr，不再拥有资源。

3.v8启动流程
    - platform 初始化
    - V8 初始化
    - Isolate 初始化
    - 创建一个 HandleScope
    - 创建 JS 代码
    - 编译 JS 代码
    - 执行 JS 代码

D:\v8\samples\cppgc\hello-world.cc

``` CPP

\\"D:\v8\samples\cppgc\hello-world.cc"  
class Rope final : public cppgc::GarbageCollected<Rope> {
 public:
  explicit Rope(std::string part, Rope* next = nullptr)
      : part_(std::move(part)), next_(next) {}  // 初始化赋值part->part_,next->next_  使用move减少内存赋值消耗

  void Trace(cppgc::Visitor* visitor) const { visitor->Trace(next_); }

 private:
  const std::string part_;
  const cppgc::Member<Rope> next_;

  friend std::ostream& operator<<(std::ostream& os, const Rope& rope) {
    os << rope.part_;
    if (rope.next_) {
      os << *rope.next_;
    }
    return os;
  }
};
```

1.**final 修饰** C++类表示该类不可做为基类使用，即无派生类；
2.**public 修饰**继承关系（public 属性仍为 public ， protected 仍为 protected）；
3.**奇异递归模板模式(Curiously Recurring Template Pattern, CRTP)**是一种在C++中常见的模板编程技巧。它的核心思想是让派生类将自身作为模板参数传递给基类，从而实现更灵活的功能扩展和性能优化。
CRTP的实现方式是通过模板基类接受派生类作为模板参数。在基类中，可以通过static_cast将this指针转换为派生类类型，从而调用派生类的特定方法。这种设计假设派生类总是继承自模板基类，因此转换是安全的。

``` CPP
\\CPTR简易实现
template <typename T>
class Base {
public:
void func() {
static_cast<T*>(this)->op();
}
};

class Derived : public Base<Derived> {
public:
void op() {
std::cout << "Derived::op()" << std::endl;
}
};

int main() {
Derived d;
d.func(); // 输出: Derived::op()
return 0;
}
```

4.**explicit** 是一个关键字，主要用于修饰单参数构造函数（包括只有一个参数的构造函数，或除第一个参数外其他参数都有默认值的构造函数），其核心作用是：禁止编译器对该构造函数进行隐式类型转换，仅允许显式调用。

``` CPP
class MyInt {
public:
    // 单参数构造函数（无 explicit）
    MyInt(int value) : m_value(value) {} 
private:
    int m_value;
};

void func(MyInt obj) { 
    // 接收 MyInt 类型的参数
}

int main() {
    MyInt a = 10;  // 隐式转换：编译器自动调用 MyInt(10) 生成对象
    func(20);      // 隐式转换：20 被自动转为 MyInt(20) 传递给 func
    return 0;
}

```

5.**const** 是常量成员函数的修饰符，其核心作用是：声明该函数不会修改当前对象（this 指向的实例）的非静态数据成员，也不会调用其他非 const 的成员函数
